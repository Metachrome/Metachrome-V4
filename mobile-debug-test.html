<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Debug Test - METACHROME</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: white;
            padding: 20px;
            min-height: 100vh;
        }
        
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.9);
            color: #00ff00;
            padding: 10px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            z-index: 10000;
            border: 1px solid #00ff00;
        }
        
        .test-section {
            background: #2a2a2a;
            margin: 20px 0;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #4CAF50;
        }
        
        .test-button {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
        }
        
        .test-button:active {
            transform: translateY(0);
        }
        
        .status-display {
            background: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre-wrap;
            border: 1px solid #555;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999999;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal-content {
            background: #059669;
            color: white;
            padding: 32px;
            border-radius: 16px;
            text-align: center;
            max-width: 350px;
            width: 100%;
            border: 4px solid white;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.8);
            animation: modalSlideIn 0.3s ease-out;
        }
        
        .modal-content.lost {
            background: #dc2626;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 16px;
        }
        
        .modal-amount {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 16px;
        }
        
        .modal-detail {
            font-size: 16px;
            margin-bottom: 8px;
            opacity: 0.9;
        }
        
        .modal-close {
            background: white;
            color: #059669;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
            margin-top: 12px;
        }
        
        .modal-close:hover {
            transform: scale(1.05);
        }
        
        .modal-close.lost {
            color: #dc2626;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
        .info { color: #2196F3; }
    </style>
</head>
<body>
    <div class="debug-panel" id="debugPanel">
        <div>Mobile: <span id="mobileStatus">Checking...</span></div>
        <div>Width: <span id="widthStatus">0px</span></div>
        <div>Height: <span id="heightStatus">0px</span></div>
        <div>Touch: <span id="touchStatus">No</span></div>
    </div>

    <h1>üß™ Mobile Debug Test - METACHROME</h1>
    <p>This tool helps debug mobile notification issues on the METACHROME trading platform.</p>

    <div class="test-section">
        <h2>üì± Device Information</h2>
        <div class="status-display" id="deviceInfo">Loading device information...</div>
    </div>

    <div class="test-section">
        <h2>üéØ Test Mobile Notifications</h2>
        <button class="test-button" onclick="testWinModal()">üéâ Test WIN Modal</button>
        <button class="test-button" onclick="testLoseModal()">üíî Test LOSE Modal</button>
        <button class="test-button" onclick="testNaNModal()">‚ö†Ô∏è Test NaN Issue</button>
        <button class="test-button" onclick="testPortalModal()">üöÄ Test Portal Modal</button>
    </div>

    <div class="test-section">
        <h2>üîß Z-Index Tests</h2>
        <button class="test-button" onclick="testZIndex(999999)">Test Z-Index 999999</button>
        <button class="test-button" onclick="testZIndex(9999999)">Test Z-Index 9999999</button>
        <button class="test-button" onclick="testZIndex(99999999)">Test Z-Index 99999999</button>
    </div>

    <div class="test-section">
        <h2>üìä Console Logs</h2>
        <div class="status-display" id="consoleLogs">Console logs will appear here...</div>
        <button class="test-button" onclick="clearLogs()">Clear Logs</button>
    </div>

    <script>
        let logCount = 0;
        const maxLogs = 20;

        // Override console.log to capture logs
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            addLog('LOG', args.join(' '));
        };

        const originalError = console.error;
        console.error = function(...args) {
            originalError.apply(console, args);
            addLog('ERROR', args.join(' '));
        };

        function addLog(type, message) {
            const logsDiv = document.getElementById('consoleLogs');
            const timestamp = new Date().toLocaleTimeString();
            const logClass = type === 'ERROR' ? 'error' : 'info';
            
            const logEntry = document.createElement('div');
            logEntry.className = logClass;
            logEntry.textContent = `[${timestamp}] ${type}: ${message}`;
            
            logsDiv.appendChild(logEntry);
            
            // Keep only last maxLogs entries
            while (logsDiv.children.length > maxLogs) {
                logsDiv.removeChild(logsDiv.firstChild);
            }
            
            // Scroll to bottom
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        function clearLogs() {
            document.getElementById('consoleLogs').innerHTML = 'Console logs cleared...';
        }

        function updateDeviceInfo() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const isMobile = width < 768;
            const hasTouch = 'ontouchstart' in window;
            const userAgent = navigator.userAgent;
            
            // Update debug panel
            document.getElementById('mobileStatus').textContent = isMobile ? 'YES' : 'NO';
            document.getElementById('mobileStatus').className = isMobile ? 'success' : 'error';
            document.getElementById('widthStatus').textContent = width + 'px';
            document.getElementById('heightStatus').textContent = height + 'px';
            document.getElementById('touchStatus').textContent = hasTouch ? 'YES' : 'NO';
            
            // Update device info section
            const deviceInfo = document.getElementById('deviceInfo');
            deviceInfo.innerHTML = `
Screen Size: ${width} x ${height}px
Mobile Detected: ${isMobile ? 'YES' : 'NO'}
Touch Support: ${hasTouch ? 'YES' : 'NO'}
Pixel Ratio: ${window.devicePixelRatio || 1}
User Agent: ${userAgent}
Platform: ${navigator.platform}
Language: ${navigator.language}
Online: ${navigator.onLine ? 'YES' : 'NO'}
            `;
            
            console.log('üîÑ Device info updated:', { width, height, isMobile, hasTouch });
        }

        function createModal(data) {
            console.log('üéØ Creating modal with data:', data);
            
            // Remove any existing modals
            const existingModals = document.querySelectorAll('.modal-overlay');
            existingModals.forEach(modal => modal.remove());
            
            const overlay = document.createElement('div');
            overlay.className = 'modal-overlay';
            overlay.onclick = () => {
                console.log('üéØ Modal overlay clicked, closing');
                overlay.remove();
            };
            
            const content = document.createElement('div');
            content.className = `modal-content ${data.won ? '' : 'lost'}`;
            content.onclick = (e) => e.stopPropagation();
            
            const pnlDisplay = isNaN(data.pnl) ? '0.00' : (data.pnl >= 0 ? '+' : '') + data.pnl.toFixed(2);
            
            content.innerHTML = `
                <div class="modal-title">
                    ${data.won ? 'üéâ TRADE WON!' : 'üíî TRADE LOST'}
                </div>
                <div class="modal-amount">
                    ${pnlDisplay} USDT
                </div>
                <div class="modal-detail">
                    Direction: ${data.direction.toUpperCase()}
                </div>
                <div class="modal-detail">
                    Amount: ${data.amount} USDT
                </div>
                <div class="modal-detail">
                    Entry: ${data.entryPrice.toFixed(2)} ‚Üí Final: ${data.finalPrice.toFixed(2)}
                </div>
                <button class="modal-close ${data.won ? '' : 'lost'}" onclick="this.closest('.modal-overlay').remove()">
                    Close
                </button>
            `;
            
            overlay.appendChild(content);
            document.body.appendChild(overlay);
            
            console.log('üéØ Modal created and added to DOM');
            
            // Auto-close after 10 seconds
            setTimeout(() => {
                if (overlay.parentNode) {
                    console.log('üéØ Auto-closing modal after 10 seconds');
                    overlay.remove();
                }
            }, 10000);
            
            return overlay;
        }

        function testWinModal() {
            console.log('üéâ Testing WIN modal');
            createModal({
                won: true,
                pnl: 15.50,
                direction: 'up',
                amount: 100,
                entryPrice: 50000,
                finalPrice: 51550
            });
        }

        function testLoseModal() {
            console.log('üíî Testing LOSE modal');
            createModal({
                won: false,
                pnl: -100,
                direction: 'down',
                amount: 100,
                entryPrice: 50000,
                finalPrice: 49000
            });
        }

        function testNaNModal() {
            console.log('‚ö†Ô∏è Testing NaN modal');
            createModal({
                won: true,
                pnl: NaN,
                direction: 'up',
                amount: 100,
                entryPrice: 50000,
                finalPrice: 51000
            });
        }

        function testPortalModal() {
            console.log('üöÄ Testing Portal-style modal');
            const modal = createModal({
                won: true,
                pnl: 25.75,
                direction: 'up',
                amount: 250,
                entryPrice: 50000,
                finalPrice: 52575
            });
            
            // Add portal-specific styling
            modal.style.position = 'fixed';
            modal.style.zIndex = '999999';
            modal.style.pointerEvents = 'auto';
        }

        function testZIndex(zIndex) {
            console.log(`üîß Testing Z-Index: ${zIndex}`);
            const modal = createModal({
                won: true,
                pnl: 10.00,
                direction: 'up',
                amount: 100,
                entryPrice: 50000,
                finalPrice: 51000
            });
            
            modal.style.zIndex = zIndex;
            console.log(`üîß Modal Z-Index set to: ${zIndex}`);
        }

        // Initialize
        updateDeviceInfo();
        window.addEventListener('resize', updateDeviceInfo);
        
        console.log('üß™ Mobile Debug Test initialized');
        console.log('üì± Current device status:', {
            width: window.innerWidth,
            height: window.innerHeight,
            mobile: window.innerWidth < 768,
            touch: 'ontouchstart' in window
        });
    </script>
</body>
</html>
