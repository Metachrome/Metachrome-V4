<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Notification Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
        }
        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }
        .test-button:hover {
            background: #2980b9;
        }
        .result {
            background: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîî Production Notification Test</h1>
        <p>This will test if the notification fix is deployed to production.</p>
        
        <button class="test-button" onclick="testProductionSite()">Test Production Site</button>
        <button class="test-button" onclick="checkDeploymentStatus()">Check Deployment Status</button>
        
        <div id="results"></div>
    </div>

    <script>
        function testProductionSite() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="result">üîç Testing production site...</div>';
            
            // Open production site in new tab
            const productionUrl = 'https://metachrome-v2-production.up.railway.app/trade/options';
            window.open(productionUrl, '_blank');
            
            results.innerHTML += `
                <div class="result">
                    <h3>üåê Production Site Opened</h3>
                    <p><strong>URL:</strong> ${productionUrl}</p>
                    <p><strong>Instructions:</strong></p>
                    <ol>
                        <li>Log in to the production site</li>
                        <li>Go to the Options trading page</li>
                        <li>Place a trade</li>
                        <li>Check which notification appears:
                            <ul>
                                <li><strong>‚úÖ CORRECT:</strong> Red desktop notification (top-right corner)</li>
                                <li><strong>‚ùå WRONG:</strong> Mobile notification (center overlay)</li>
                            </ul>
                        </li>
                        <li>Report back what you see</li>
                    </ol>
                </div>
            `;
        }
        
        function checkDeploymentStatus() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="result">üìä Checking deployment status...</div>';
            
            // Get current detection info
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            const isSmallScreen = screenWidth < 768;
            const isTouchDevice = 'ontouchstart' in window;
            const userAgent = navigator.userAgent;
            
            // ENHANCED MOBILE DETECTION - More strict criteria (same as in the app)
            const isMobileUserAgent = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
            const isReallySmallScreen = screenWidth < 600; // Even stricter threshold
            const isActuallyMobile = (isSmallScreen && isTouchDevice && isMobileUserAgent) || isReallySmallScreen;
            
            // SAFETY CHECK: If screen is large (desktop), force desktop notification
            const forceDesktop = screenWidth >= 1024; // Definitely desktop
            const shouldUseMobile = isActuallyMobile && !forceDesktop;
            
            results.innerHTML = `
                <div class="result">
                    <h3>üìä Current Detection Status</h3>
                    <p><strong>Screen Width:</strong> ${screenWidth}px</p>
                    <p><strong>Screen Height:</strong> ${screenHeight}px</p>
                    <p><strong>Is Small Screen (&lt; 768px):</strong> ${isSmallScreen}</p>
                    <p><strong>Is Touch Device:</strong> ${isTouchDevice}</p>
                    <p><strong>Is Mobile User Agent:</strong> ${isMobileUserAgent}</p>
                    <p><strong>Is Really Small Screen (&lt; 600px):</strong> ${isReallySmallScreen}</p>
                    <p><strong>Is Actually Mobile:</strong> ${isActuallyMobile}</p>
                    <p><strong>Force Desktop (‚â• 1024px):</strong> ${forceDesktop}</p>
                    <p><strong>Should Use Mobile Notification:</strong> ${shouldUseMobile}</p>
                    <p><strong>Should Use Desktop Notification:</strong> ${!shouldUseMobile}</p>
                </div>
                <div class="result">
                    <h3>üéØ Expected Behavior</h3>
                    <p>Based on your current device, you should see:</p>
                    <p><strong>${!shouldUseMobile ? 'üñ•Ô∏è DESKTOP NOTIFICATION' : 'üì± MOBILE NOTIFICATION'}</strong></p>
                    ${!shouldUseMobile ? 
                        '<p>‚úÖ Red notification in top-right corner</p>' : 
                        '<p>üì± Full-screen mobile notification in center'
                    }
                </div>
                <div class="result">
                    <h3>üîß Troubleshooting</h3>
                    <p>If the production site shows the wrong notification:</p>
                    <ol>
                        <li><strong>Hard Refresh:</strong> Press Ctrl+F5 to clear cache</li>
                        <li><strong>Clear Browser Cache:</strong> Clear all cached data for the site</li>
                        <li><strong>Check Network Tab:</strong> Verify new JavaScript files are loading</li>
                        <li><strong>Check Console:</strong> Look for any JavaScript errors</li>
                    </ol>
                </div>
            `;
        }
    </script>
</body>
</html>
